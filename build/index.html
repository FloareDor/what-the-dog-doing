<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover"><title>Scotty Survival</title><style>:root{--bg:#0a0d12;--sky:#1a2940;--ink:#ecf3ff;--red:#ef4f6c;--mint:#69f0c9;--gold:#ffd56d;--line:#2f4868}*{box-sizing:border-box}html,body{margin:0;width:100%;height:100%;overflow:hidden;background:var(--bg);color:var(--ink);font-family:Trebuchet MS,Avenir Next,Segoe UI,sans-serif}body{touch-action:none}canvas{display:block;width:100%;height:100%}</style></head><body><canvas id="c"></canvas><script>(()=>{const t=document.getElementById("c"),e=t.getContext("2d");let l=360,n=740,a=1,i=0;const r=[{id:"home",n:"Cohon Centre",x:260,y:900,r:170,c:"#8ec0ff"},{id:"nsh",n:"nsh",x:980,y:460,r:170,c:"#79d7ff"},{id:"mel",n:"mellon",x:1880,y:1260,r:185,c:"#ffd58f"}],s=["i need to go out","these things are scary","may lord help us","can we ever go out?"],f=["a dog?","scotty??","what the dog doing?"],o={};function h(t){const e=new Image;return e.src="black_scottish_terrier_dog_with_red_scarf/rotations/"+t+".png",e}o.e=h("east"),o.w=h("west"),o.ne=h("north-east"),o.nw=h("north-west"),o.se=h("south-east"),o.sw=h("south-west");let c=0;function m(t,e,l,n){if(!c)return;const a=c.createOscillator(),i=c.createGain();a.type=l||"triangle",a.frequency.value=t,i.gain.value=n||.02,i.gain.exponentialRampToValueAtTime(1e-4,c.currentTime+e),a.connect(i).connect(c.destination),a.start(),a.stop(c.currentTime+e)}let d=0;function x(){if(!y.start)return;const t=performance.now();t-d<1200||(d=t,m(392,.07,"square",.02),m(523,.08,"triangle",.014))}const y={start:0,dead:0,lvup:0,t:0,time:0,kills:0,spawnT:0,nextSpawn:.8,msg:"",msgT:0,level:1,xp:0,nextXp:24,stop:0,shake:0,xpPulse:0,cardT:0,best:+localStorage.ss_best||0,choices:[],homeNeed:2,homeGot:0,sch:{nsh:0,mel:0},pz:0,uq:[],inB:"",bs:0,bd:0},g={x:260,y:900,vx:0,vy:0,r:15,hp:100,maxHp:100,speed:185,fireCd:0,fireRate:.46,dmg:12,range:400,shots:1,magnet:88,face:1,rx:0,ry:0,flash:0,gx:1,gy:0,zc:0,zr:0,zt:0,zx:1,zy:0,zcd:0,zDur:1,zSpd:2.1,zLoad:1.5,zCool:5.5,zDmg:24,zDr:.55,zb:0,zp:0,mkOn:0,mkT:0,mkI:8.8,mkS:0,mkD:14,mkR:54,mkSl:.5,chDo:20,chBurst:14,cat:0,catM:0,bot:0,bx:0,by:0,ba:0,bcd:0,bRate:.5,bDmg:.55,bRange:430},b={l:0,r:0,u:0,d:0,gr:0};let p=-1,u=0;const M={x:78,y:0,r:42,kr:16,tx:0,ty:0,ax:0,ay:0},S=[],z=[],T=[],k=[],v=[];function P(t,e){return t+Math.random()*(e-t)}function w(t,e,l){return t<e?e:t>l?l:t}function R(t){const e=t-1;return 1+2.70158*e*e*e+1.70158*e*e}function I(t,l,n,a,i){const r=Math.max(0,Math.min(i,.5*Math.min(n,a)));e.beginPath(),e.moveTo(t+r,l),e.lineTo(t+n-r,l),e.quadraticCurveTo(t+n,l,t+n,l+r),e.lineTo(t+n,l+a-r),e.quadraticCurveTo(t+n,l+a,t+n-r,l+a),e.lineTo(t+r,l+a),e.quadraticCurveTo(t,l+a,t,l+a-r),e.lineTo(t,l+r),e.quadraticCurveTo(t,l,t+r,l),e.closePath()}function q(){const t=l<560,e=t?l-14:Math.min(l-20,620),a=t?w(.48*n,296,390):w(.4*n,268,340),i=.5*(l-e),r=n-a-12,s=[];if(t){const t=8,l=e-22,n=Math.max(74,Math.min(100,(a-84-2*t)/3)),f=r+50;for(let e=0;e<3;e++)s.push({x:i+14,y:f+e*(n+t),w:l,h:n})}else{const t=10,l=(e-32-2*t)/3,n=Math.max(102,Math.min(130,a-82)),f=r+52;for(let e=0;e<3;e++)s.push({x:i+16+e*(l+t),y:f,w:l,h:n})}return{mobile:t,bx:i,by:r,bw:e,bh:a,rects:s}}function D(t,l,n,a,i,r){const s=t.split(" ");let f="",o=0;for(let t=0;t<s.length;t++){const h=f?f+" "+s[t]:s[t];if(e.measureText(h).width<=a)f=h;else{if(e.fillText(f,l,n+o*i),o++,o>=r)return;f=s[t]}}o<r&&f&&e.fillText(f,l,n+o*i)}function C(t){return t.includes("Chemical")?"ðŸ§ª":t.includes("Bot")?"ðŸ¤–":t.includes("Zoomies")?"âš¡":t.includes("Territory")?"ðŸ’§":"â­"}function A(t){for(let e=0;e<r.length;e++)if(r[e].id===t)return r[e];return 0}function L(t,e,l){const n=l||0;for(let l=0;l<r.length;l++){const a=r[l],i=t-a.x,s=e-a.y;if(i*i+s*s<(a.r+n)*(a.r+n))return a}return 0}function W(t,e){const l=e||0;let n=0;for(let e=0;e<r.length;e++){const a=r[e];let i=t.x-a.x,s=t.y-a.y,f=Math.hypot(i,s)||1;const o=a.r+l;if(f<o){if(f<.001){const t=Math.random()*Math.PI*2;i=Math.cos(t),s=Math.sin(t),f=1}t.x=a.x+i/f*o,t.y=a.y+s/f*o,n=1}}return n}function B(){const t=Math.min(l-24,420),e=Math.min(n-130,260),a=.5*(l-t),i=.5*(n-e)+24,r=(t-36-20)/3,s=i+e-72;return{bx:a,by:i,bw:t,bh:e,btn:[{x:a+18,y:s,w:r,h:46},{x:a+18+r+10,y:s,w:r,h:46},{x:a+18+2*(r+10),y:s,w:r,h:46}]}}function O(t){if(!y.pz)if("nsh"===t){const t=3*Math.random()|0,e=(t+1+(2*Math.random()|0))%3;y.pz={id:"nsh",seq:[t,e],step:0},y.msg="research",y.msgT=1.2}else"mel"===t&&(y.pz={id:"mel",seq:[3*Math.random()|0,3*Math.random()|0,3*Math.random()|0],step:0},y.msg="research",y.msgT=1.2)}function K(t){if(!y.pz)return;const e=y.pz;if(t===e.seq[e.step]){if(e.step++,m(620+70*e.step,.04,"triangle",.018),e.step>=e.seq.length){const t=e.id;y.pz=0,function(t){"nsh"===t&&2!==y.sch.nsh?(y.sch.nsh=2,Y("nsh"),y.msg="nsh: bot unlock",y.msgT=2.1,H(.12),J(g.x,g.y,"#79d7ff",16,95),m(760,.07,"square",.024)):"mel"===t&&2!==y.sch.mel&&(y.sch.mel=2,Y("mel"),y.msg="mel: chem unlock",y.msgT=2.1,H(.12),J(g.x,g.y,"#ffd58f",16,95),m(720,.07,"square",.024))}(t)}}else e.step=0,H(.03),m(180,.06,"square",.02),y.msg="retry",y.msgT=.55}function E(t){"nsh"===t&&0===y.sch.nsh?(y.sch.nsh=1,x(),O("nsh"),y.msg="help",y.msgT=1.4,m(640,.05,"triangle",.02)):"mel"===t&&0===y.sch.mel&&(y.sch.mel=1,x(),O("mel"),y.msg="help",y.msgT=1.4,m(680,.05,"triangle",.02))}function X(){g.cat&&(g.catM=1-g.catM,y.msg="chem: "+(g.catM?"cor":"stick"),y.msgT=.95,m(g.catM?520:460,.04,"triangle",.02))}function Y(t){y.uq.indexOf(t)<0&&y.uq.push(t)}function G(){if(y.lvup||y.dead||y.pz||!y.uq.length)return;const t=y.uq.shift();let e=0;"nsh"!==t||g.bot?"mel"!==t||g.cat||(e={n:"Chemical Mode",d:"sticky/corrosive puddles",f:()=>{g.cat=1,g.catM=0}}):e={n:"Bot Buddy",d:"orbit bot ally",f:()=>{g.bot=1,g.bx=g.x+20,g.by=g.y+4,g.bcd=.2,g.bRate=.5,g.bDmg=.55,g.bRange=430}},e&&(y.choices=[e,e,e],y.lvup=1,y.cardT=0,y.msg="unlock",y.msgT=1.4,m(760,.07,"triangle",.028))}function H(t){y.shake=w(y.shake+t,0,1.3)}function _(t){y.stop=Math.max(y.stop,t)}function F(){a=Math.max(1,Math.min(2,devicePixelRatio||1)),l=Math.max(320,0|innerWidth),n=Math.max(560,0|innerHeight),t.width=l*a|0,t.height=n*a|0,e.setTransform(a,0,0,a,0,0),e.imageSmoothingEnabled=!1,M.y=n-88}function Z(t,e){const l=t-M.x,n=e-M.y;return l*l+n*n<1.8*M.r*(1.8*M.r)}function N(t,e){let l=t-M.x,n=e-M.y;const a=Math.hypot(l,n)||1,i=M.r;a<10?(l=0,n=0):a>i&&(l=l/a*i,n=n/a*i),M.tx=l,M.ty=n,M.ax=l/i,M.ay=n/i}function U(){M.tx=0,M.ty=0,M.ax=0,M.ay=0}function Q(t){v.length>=420||v.push(t)}function V(t){T.length>=260||T.push(t)}function j(t){z.length>=260||z.push(t)}function J(t,e,l,n,a){const i=S.length>130?.5:S.length>90?.7:1,r=Math.max(1,n*i|0);for(let n=0;n<r;n++){const n=Math.random()*Math.PI*2,i=(a||70)*(.4+Math.random());Q({x:t,y:e,vx:Math.cos(n)*i,vy:Math.sin(n)*i,t:P(.2,.6),c:l})}}function $(t,e,l,n,a){const i=S[t],r=!!a;3===i.k&&(y.bd=1,y.bs=0,y.msg="boss down",y.msgT=1.5,H(.24),m(240,.12,"triangle",.03)),y.kills++,r?J(i.x,i.y,e||"#ff9675",Math.max(2,.35*(l||9)|0),Math.max(20,.6*(n||70))):(_(.03),H(.08),J(i.x,i.y,e||"#ff9675",l||9,n||70),m(280,.03,"square",.012));const s=260-T.length;if(s>0){const t=r?Math.random()<.25?1:0:1+(Math.random()<.4?1:0);for(let e=0;e<Math.min(t,s);e++)V({x:i.x+P(-7,7),y:i.y+P(-7,7),v:0|P(5,8),m:1,t:0})}S.splice(t,1)}function tt(t){if(y.dead=0,y.lvup=0,y.t=0,y.time=0,y.spawnT=0,y.nextSpawn=.8,y.kills=0,y.msg="",y.msgT=0,y.level=1,y.xp=0,y.nextXp=24,y.stop=0,y.shake=0,y.xpPulse=0,y.cardT=0,y.choices=[],y.homeGot=0,y.sch.nsh=0,y.sch.mel=0,y.pz=0,y.uq.length=0,y.inB="",y.bs=0,y.bd=0,g.x=260,g.y=900,g.vx=0,g.vy=0,g.hp=100,g.maxHp=100,g.speed=185,g.fireCd=0,g.fireRate=.46,g.dmg=12,g.range=400,g.shots=1,g.magnet=88,g.face=1,g.rx=0,g.ry=0,g.flash=0,g.gx=1,g.gy=0,g.zc=0,g.zr=0,g.zt=0,g.zx=1,g.zy=0,g.zcd=0,g.zDur=1,g.zSpd=2.1,g.zLoad=1.5,g.zCool=5.5,g.zDmg=24,g.zDr=.55,g.zb=0,g.zp=0,g.mkOn=0,g.mkT=0,g.mkI=8.8,g.mkS=0,g.mkD=14,g.mkR=54,g.mkSl=.5,g.chDo=20,g.chBurst=14,g.cat=0,g.catM=0,g.bot=0,g.bx=g.x+20,g.by=g.y+4,g.ba=0,g.bcd=.2,g.bRate=.5,g.bDmg=.55,g.bRange=430,S.length=0,z.length=0,T.length=0,k.length=0,v.length=0,b.l=b.r=b.u=b.d=b.gr=0,u=0,U(),y.msg="home: unlock",y.msgT=1.6,t){for(let t=0;t<24;t++)V({x:1300+P(-120,120),y:900+P(-120,120),v:7,m:1,t:0});for(let t=0;t<10;t++)V({x:330+58*t,y:900+P(-60,60),v:5,m:1,t:0})}}function et(){if(S.length>=180)return;const t=Math.random()*Math.PI*2,e=P(360,560),l=1+.045*y.time;let n=22+8*l+P(-4,8),a=56+6*l+P(-6,10),i=P(12,18),r=8+.9*l,s=0;y.time>8&&Math.random()<.24&&(s=1,a*=1.65,n*=.66,i*=.82,r*=.82),y.time>18&&Math.random()<.18&&(s=2,a*=.74,n*=2.15,i*=1.35,r*=1.28);let f=w(g.x+Math.cos(t)*e,20,2580),o=w(g.y+Math.sin(t)*e,20,1780);const h=L(f,o,10);if(h){const t=f-h.x,e=o-h.y,l=Math.hypot(t,e)||1;f=h.x+t/l*(h.r+18),o=h.y+e/l*(h.r+18)}S.push({x:f,y:o,r:i,hp:n,s:a,dmg:r,vx:0,vy:0,ht:0,sl:0,ce:0,bm:0,bt:0,bi:"",k:s})}function lt(t){for(y.xp+=t;y.xp>=y.nextXp;){y.xp-=y.nextXp,y.level++,y.nextXp=1.36*y.nextXp+9|0,at(),y.lvup=1,y.cardT=0,y.xpPulse=.65,y.msg="upgrade",y.msgT=2.1,_(.06),H(.2),m(860,.08,"triangle",.03);break}}const nt=[{n:"Rapid Fire",d:"rf",f:()=>g.fireRate=Math.max(.15,.8*g.fireRate),req:()=>1},{n:"Big Bites",d:"+dmg",f:()=>g.dmg+=8,req:()=>1},{n:"Speed Paws",d:"+spd",f:()=>g.speed+=30,req:()=>1},{n:"Extra Shot",d:"+shot",f:()=>g.shots=Math.min(5,g.shots+1),req:()=>1},{n:"Long Reach",d:"+rng",f:()=>g.range+=150,req:()=>1},{n:"Snack Magnet",d:"+mag",f:()=>g.magnet+=40,req:()=>1},{n:"Tough Fur",d:"+hp",f:()=>{g.maxHp+=32,g.hp=Math.min(g.maxHp,g.hp+32)},req:()=>1},{n:"Quick Heal",d:"heal",f:()=>g.hp=Math.min(g.maxHp,g.hp+45),req:()=>1},{n:"Zoomies Time",d:"+z time",f:()=>g.zDur=Math.min(2.6,g.zDur+.32),req:()=>1},{n:"Zoomies CD",d:"-z cd",f:()=>g.zCool=Math.max(1.4,g.zCool-.85),req:()=>1},{n:"Zoomies Speed",d:"+z spd",f:()=>g.zSpd=Math.min(4,g.zSpd+.45),req:()=>1},{n:"Zoomies Charge",d:"-z load",f:()=>g.zLoad=Math.max(.55,g.zLoad-.24),req:()=>1},{n:"Territory CD",d:"-t cd",f:()=>g.mkI=Math.max(3.2,g.mkI-.68),req:()=>g.mkOn},{n:"Territory Radius",d:"+t rad",f:()=>g.mkR=Math.min(110,g.mkR+16),req:()=>g.mkOn},{n:"Territory Duration",d:"+t dur",f:()=>g.mkD=Math.min(40,g.mkD+5),req:()=>g.mkOn},{n:"Territory Slow",d:"+t slow",f:()=>g.mkSl=Math.min(.88,g.mkSl+.12),req:()=>g.mkOn},{n:"Chemical Puddle",d:"+chem",f:()=>{g.chDo=Math.min(58,g.chDo+10),g.chBurst=Math.min(42,g.chBurst+8)},req:()=>g.cat},{n:"Chemical Radius",d:"+c rad",f:()=>g.mkR=Math.min(120,g.mkR+13),req:()=>g.cat},{n:"Chemical Tempo",d:"-c cd",f:()=>g.mkI=Math.max(2.6,g.mkI-.58),req:()=>g.cat},{n:"Bot Rate",d:"+b rate",f:()=>g.bRate=Math.max(.18,.76*g.bRate),req:()=>g.bot},{n:"Bot Damage",d:"+b dmg",f:()=>g.bDmg=Math.min(1.7,g.bDmg+.26),req:()=>g.bot},{n:"Bot Radar",d:"+b rng",f:()=>g.bRange=Math.min(820,g.bRange+95),req:()=>g.bot}];function at(){const t=nt.filter(t=>!t.req||t.req());y.choices=[];for(let e=0;e<3&&t.length;e++){const e=Math.random()*t.length|0;y.choices.push(t[e]),t.splice(e,1)}}function it(t){y.lvup&&y.choices[t]&&(y.choices[t].f(),y.lvup=0,y.msg=y.choices[t].n+" applied",y.msgT=1.4,y.xpPulse=.25,H(.08),J(g.x,g.y,"#69f0c9",12,90),G())}function rt(){c||(c=new(window.AudioContext||window.webkitAudioContext)),y.start||(y.start=1,tt(1),m(430,.05,"triangle",.02))}function st(e){p===e.pointerId&&(u=0,U(),t.hasPointerCapture(p)&&t.releasePointerCapture(p),p=-1)}addEventListener("resize",F),addEventListener("keydown",function(t){const e=t.code;if("Space"!==e&&"ArrowUp"!==e&&"ArrowDown"!==e&&"ArrowLeft"!==e&&"ArrowRight"!==e||t.preventDefault(),"Space"!==e&&"Enter"!==e||rt(),y.dead&&("Space"===e||"Enter"===e||"KeyR"===e))return tt(1),void m(360,.05,"triangle",.02);y.lvup?"Digit1"===e?it(0):"Digit2"===e?it(1):"Digit3"===e&&it(2):y.pz?"Digit1"===e?K(0):"Digit2"===e?K(1):"Digit3"===e&&K(2):y.start&&!y.dead&&("KeyQ"!==e?"KeyA"===e||"ArrowLeft"===e?b.l=1:"KeyD"===e||"ArrowRight"===e?b.r=1:"KeyW"===e||"ArrowUp"===e?b.u=1:"KeyS"===e||"ArrowDown"===e?b.d=1:"KeyE"!==e&&"ShiftLeft"!==e&&"ShiftRight"!==e||(b.gr=1):X())}),addEventListener("keyup",function(t){const e=t.code;"KeyA"===e||"ArrowLeft"===e?b.l=0:"KeyD"===e||"ArrowRight"===e?b.r=0:"KeyW"===e||"ArrowUp"===e?b.u=0:"KeyS"===e||"ArrowDown"===e?b.d=0:"KeyE"!==e&&"ShiftLeft"!==e&&"ShiftRight"!==e||(b.gr=0)}),t.addEventListener("pointerdown",function(e){if(!(p>=0&&p!==e.pointerId)){if(p=e.pointerId,t.setPointerCapture(p),rt(),y.dead)return tt(1),void m(360,.05,"triangle",.02);if(y.lvup)!function(t,e){if(!y.lvup)return;const l=q().rects;for(let n=0;n<l.length;n++){const a=l[n];if(t>=a.x&&t<=a.x+a.w&&e>=a.y&&e<=a.y+a.h){it(n);break}}}(e.clientX,e.clientY);else{if(y.pz){const t=B();for(let l=0;l<3;l++){const n=t.btn[l];if(e.clientX>=n.x&&e.clientX<=n.x+n.w&&e.clientY>=n.y&&e.clientY<=n.y+n.h)return void K(l)}return}y.start&&!y.dead&&g.cat&&function(t,e){const n=l-18-44;return t>=n&&t<=n+44&&e>=66&&e<=110}(e.clientX,e.clientY)?X():Z(e.clientX,e.clientY)&&(u=1,N(e.clientX,e.clientY))}}},{passive:1}),t.addEventListener("pointermove",function(t){p!==t.pointerId||!y.start||y.dead||y.lvup||(u||Z(t.clientX,t.clientY))&&(u=1,N(t.clientX,t.clientY))},{passive:1}),t.addEventListener("pointerup",st,{passive:1}),t.addEventListener("pointercancel",st,{passive:1}),F(),tt(1),requestAnimationFrame(function t(h){i||(i=h);let c=.001*(h-i);i=h,c=Math.max(0,Math.min(.034,c)),function(t){const e=t;y.msgT>0&&(y.msgT-=e),y.stop>0&&(y.stop=Math.max(0,y.stop-e),t*=.06),y.shake>0&&(y.shake=Math.max(0,y.shake-2.2*e)),y.xpPulse>0&&(y.xpPulse=Math.max(0,y.xpPulse-1.7*e)),g.flash>0&&(g.flash=Math.max(0,g.flash-7*e)),g.zb>0&&(g.zb=Math.max(0,g.zb-e)),g.zp>0&&(g.zp=Math.max(0,g.zp-e)),g.rx*=Math.max(0,1-18*e),g.ry*=Math.max(0,1-18*e),g.zcd>0&&(g.zcd=Math.max(0,g.zcd-e)),g.mkS>0&&(g.mkS=Math.max(0,g.mkS-e)),g.mkT>0&&g.zt<=0&&(g.mkT=Math.max(0,g.mkT-e));for(let e=k.length-1;e>=0;e--){const l=k[e];l.t-=t,l.t<=0&&k.splice(e,1)}for(let e=v.length-1;e>=0;e--){const l=v[e];l.t-=t,l.x+=l.vx*t,l.y+=l.vy*t,l.vy+=480*t,l.t<=0&&v.splice(e,1)}if(!y.start||y.dead)return;if(y.lvup)return void(y.cardT=Math.min(.9,y.cardT+e));if(y.pz)return void(y.t+=t);y.t+=t;const l=A("nsh"),n=A("mel");g.mkOn&&0===y.sch.nsh&&Math.hypot(g.x-l.x,g.y-l.y)<l.r&&E("nsh"),2===y.sch.nsh&&0===y.sch.mel&&Math.hypot(g.x-n.x,g.y-n.y)<n.r&&E("mel"),G();const a=(b.r?1:0)-(b.l?1:0),i=(b.d?1:0)-(b.u?1:0),r=Math.hypot(M.ax,M.ay);let s=a,f=i;u&&r>.12&&(s+=M.ax,f+=M.ay);let o=Math.hypot(s,f);o>1&&(s/=o,f/=o);const h=(Math.hypot(a,i)>.05||u&&r>.12)&&g.mkS<=0;if(g.mkOn&&g.mkT<=0&&g.mkS<=0&&g.zt<=0&&g.zr<=0&&g.zc<=0&&(k.length>=18&&k.shift(),k.push({x:g.x+4*g.gx,y:g.y+8,r:g.mkR,t:g.mkD,d:g.mkD,m:g.cat?g.catM:0}),g.mkS=.32,g.mkT=g.mkI,y.msg="territory",y.msgT=.7,_(.02),H(.05),J(g.x,g.y+8,"#ffd56d",10,46),m(560,.04,"triangle",.02)),g.zt<=0)if(!h&&g.zcd<=0&&g.mkS<=0){if(g.zc=Math.min(g.zLoad,g.zc+t),g.zc>.25){const e=g.zc/g.zLoad;g.rx+=.9*(2*Math.random()-1)*e*60*t,g.ry+=.9*(2*Math.random()-1)*e*60*t,H(7e-4*e*60*t)}g.zc>=g.zLoad&&!g.zr&&(g.zr=1,y.msg="zoomies ready",y.msgT=1.1,H(.08),m(760,.05,"triangle",.024))}else if(g.zr){g.zt=g.zDur,g.zr=0,g.zc=0;const t=o||1;g.zx=s/t,g.zy=f/t,_(.04),H(.28),g.flash=.09,g.gx=g.zx,g.gy=g.zy,J(g.x,g.y,"#9dffea",18,120),m(980,.06,"square",.028)}else g.zc=0;if(g.zt>0){if(g.zt=Math.max(0,g.zt-t),h){g.zx=.85*g.zx+.15*s,g.zy=.85*g.zy+.15*f;const t=Math.hypot(g.zx,g.zy)||1;g.zx/=t,g.zy/=t}const e=g.zb>0?1.35:1;g.vx=g.zx*g.speed*g.zSpd*e,g.vy=g.zy*g.speed*g.zSpd*e,g.face=g.vx>=0?1:-1,g.rx-=8*g.zx*t*60,g.ry-=6*g.zy*t*60,Math.random()<.65&&Q({x:g.x-P(-6,6),y:g.y-P(-6,6),vx:.12*-g.vx+P(-35,35),vy:.12*-g.vy+P(-35,35),t:P(.1,.25),c:"#8fffe5"}),g.zt<=0&&(g.zcd=g.zCool,y.msg="zoomies cd",y.msgT=.65,m(420,.04,"triangle",.016))}else g.vx=s*g.speed,g.vy=f*g.speed,Math.abs(g.vx)>.5&&(g.face=g.vx>0?1:-1),g.mkS>0&&(g.rx+=.5*Math.sin(45*y.t),Math.random()<.7&&Q({x:g.x+P(-5,5),y:g.y+10+P(-3,3),vx:P(-14,14),vy:P(6,30),t:P(.12,.26),c:"#ffd56d"}));if(g.x=w(g.x+g.vx*t,12,2588),g.y=w(g.y+g.vy*t,12,1788),g.zt>0&&g.zp<=0)for(let t=0;t<k.length;t++){const e=k[t],l=g.x-e.x,n=g.y-e.y;if(l*l+n*n<e.r*e.r){g.zp=.22,g.zb=.48,J(g.x,g.y,"#8fffe5",8,95),m(740,.03,"triangle",.02);for(let t=S.length-1;t>=0;t--){const l=S[t],n=l.x-e.x,a=l.y-e.y;n*n+a*a<e.r*e.r&&(l.hp-=2.2*g.zDmg,l.ht=.13,l.vx+=260*g.zx,l.vy+=260*g.zy,l.hp<=0&&$(t,"#8fffe5",10,80,1))}break}}const c=L(g.x,g.y,-6);c||(y.time+=t);const d=c?c.id:"";if(y.inB=d,g.bot){g.ba+=2.3*t;const e=g.x+34*Math.cos(g.ba),l=g.y+20*Math.sin(1.17*g.ba);if(g.bx+=(e-g.bx)*Math.min(1,8*t),g.by+=(l-g.by)*Math.min(1,8*t),c||(g.bcd-=t),!c&&g.bcd<=0){let t=0,e=g.bRange*g.bRange;for(let l=0;l<S.length;l++){const n=S[l],a=n.x-g.bx,i=n.y-g.by,r=a*a+i*i;r<e&&(e=r,t=n)}if(t){const e=Math.hypot(t.x-g.bx,t.y-g.by)||1;j({x:g.bx,y:g.by,vx:(t.x-g.bx)/e*540,vy:(t.y-g.by)/e*540,d:g.dmg*g.bDmg,life:.9,pier:0,c:"#9de6ff"}),g.bcd=g.bRate}else g.bcd=.2}}g.fireCd-=t,!c&&g.fireCd<=0&&(g.fireCd=g.fireRate,function(){const t=function(){let t=0,e=1e9;for(let l=0;l<S.length;l++){const n=S[l],a=n.x-g.x,i=n.y-g.y,r=a*a+i*i;r<e&&(e=r,t=n)}return t}();if(!t)return;let e=t.x-g.x,l=t.y-g.y,n=Math.hypot(e,l)||1;if(n>g.range)return;e/=n,l/=n;const a=g.shots;for(let t=0;t<a;t++){const n=1===a?0:.18*(t-(a-1)/2),i=Math.cos(n),r=Math.sin(n),s=e*i-l*r,f=e*r+l*i;j({x:g.x,y:g.y,vx:520*s,vy:520*f,d:g.dmg,life:1.05,pier:1})}g.gx=e,g.gy=l,g.rx-=6*e,g.ry-=4*l,g.flash=.07,g.face=e>=0?1:-1,J(g.x+16*e,g.y+10*l,"#ffd56d",3,35),H(.025),m(640,.04,"square",.018)}()),y.spawnT-=t,2!==y.sch.mel||y.bs||y.bd||!(y.kills>26||y.time>52)||function(){if(y.bs||y.bd||S.length>=180)return;const t=Math.random()*Math.PI*2,e={x:w(g.x+520*Math.cos(t),40,2560),y:w(g.y+520*Math.sin(t),40,1760),r:34,hp:560+10*y.time,s:44,dmg:22,vx:0,vy:0,ht:0,sl:0,ce:0,bm:0,bt:0,bi:"",k:3};W(e,28),S.push(e),y.bs=1,y.msg="boss!",y.msgT=1.2,m(170,.15,"sawtooth",.03),H(.2)}(),y.spawnT<=0&&(y.spawnT=y.nextSpawn,y.nextSpawn=Math.max(.18,.78-.018*y.time),et(),!y.bs&&y.time>26&&Math.random()<.28&&et());for(let e=z.length-1;e>=0;e--){const l=z[e];if(l.life-=t,l.x+=l.vx*t,l.y+=l.vy*t,l.life<=0||l.x<-20||l.y<-20||l.x>2620||l.y>1820)z.splice(e,1);else for(let t=S.length-1;t>=0;t--){const n=S[t],a=n.x-l.x,i=n.y-l.y;if(a*a+i*i<(n.r+3)*(n.r+3)&&(n.hp-=l.d,n.ht=.09,n.vx+=.07*l.vx,n.vy+=.07*l.vy,l.pier--,n.hp<=0&&$(t,"#ff9675",9,70),l.pier<0)){z.splice(e,1);break}}}let x=0,p=0,R=0;const I=c;for(let e=S.length-1;e>=0;e--){const l=S[e];let n=g.x,a=g.y;if(I)if(l.bi!==I.id&&(l.bi=I.id,l.bm=0,l.bt=P(.9,1.7)),l.bt-=t,l.bt<=0&&(0===l.bm?(l.bm=1,l.bt=P(1.1,2.1)):(l.bm=0,l.bt=P(.9,1.7))),0===l.bm){const t=g.x-I.x,e=g.y-I.y,l=Math.hypot(t,e)||1;n=I.x+t/l*(I.r+8),a=I.y+e/l*(I.r+8)}else{const t=l.x-I.x,i=l.y-I.y,r=Math.hypot(t,i)||1;n=l.x+t/r*220+-i/r*Math.sin(2*y.t+e)*30,a=l.y+i/r*220+t/r*Math.sin(2*y.t+e)*30}else l.bi="",l.bt=0,l.bm=0;const i=n-l.x,r=a-l.y,s=Math.hypot(i,r)||1;let f=1,o=0,h=0;for(let t=0;t<k.length;t++){const e=k[t],n=l.x-e.x,a=l.y-e.y;if(n*n+a*a<e.r*e.r){h=e.m?1:0;const t=e.m?.36:.72;f=Math.min(f,1-t),o=1,e.m&&g.cat&&l.ce<=0&&(l.ce=.55,l.hp-=g.chBurst,J(l.x,l.y,"#ffd58f",5,44));break}}if(g.bot){const t=l.x-g.bx,e=l.y-g.by;t*t+e*e<400&&(f=Math.min(f,.65))}if(l.sl=o,o){const n=g.cat&&h?g.chDo:0;if(n>0&&(l.hp-=n*t),l.ht=Math.max(l.ht,.08),l.hp<=0){$(e,"#f7d96b",8,60);continue}}l.ce>0&&(l.ce=Math.max(0,l.ce-t)),l.vx*=Math.max(0,1-8*t),l.vy*=Math.max(0,1-8*t),l.ht=Math.max(0,l.ht-t),l.x+=(i/s*l.s*f+l.vx)*t,l.y+=(r/s*l.s*f+l.vy)*t,W(l,6)&&(l.vx*=.4,l.vy*=.4);const c=g.x-l.x,m=g.y-l.y;if((Math.hypot(c,m)||1)<l.r+g.r-1){if(g.zt>0){if(l.hp-=g.zDmg,l.ht=.12,l.vx+=280*g.zx,l.vy+=280*g.zy,p++,l.hp<=0){$(e,"#8fffe5",12,90,1),R++;continue}x+=.35*l.dmg;continue}x+=l.dmg}}var q;p>0&&(_(Math.min(.04,.012*p)),H(Math.min(.24,.04*p)),y.xpPulse=Math.min(.6,y.xpPulse+.06*p),m(260,.02,"square",.016),R>1&&m(310,.02,"square",.013)),x>0&&(q=x*t,g.zt>0&&(q*=g.zDr),g.hp-=q,H(.03),g.hp<=0&&(g.hp=0,y.dead=1,y.start=1,y.kills>y.best&&(y.best=0|y.kills,localStorage.ss_best=y.best),y.msg="swarmed",y.msgT=999,_(.09),H(.42),m(120,.22,"sawtooth",.05),J(g.x,g.y,"#ff6f89",26,130)));for(let e=T.length-1;e>=0;e--){const l=T[e],n=g.x-l.x,a=g.y-l.y,i=Math.hypot(n,a)||1;i<g.magnet&&(l.x+=n/i*240*t,l.y+=a/i*240*t),i<g.r+8&&(lt(l.v),T.splice(e,1),y.xpPulse=Math.min(.5,y.xpPulse+.11),J(g.x,g.y,"#69f0c9",4,40),g.mkOn||(y.homeGot++,y.homeGot>=y.homeNeed&&(g.mkOn=1,g.mkT=.25,y.msg="territory: nsh",y.msgT=2.2,m(820,.07,"triangle",.028),J(g.x,g.y,"#ffd56d",16,95))))}(b.gr||u)&&Math.random()<.04&&y.time>2&&V({x:w(g.x+P(-20,20),12,2588),y:w(g.y+P(-20,20),12,1788),v:4,m:1,t:0})}(c),function(){const t=y.shake*y.shake,i=10*(2*Math.random()-1)*t,h=10*(2*Math.random()-1)*t;e.setTransform(a,0,0,a,i,h);const c=w(g.x-.5*l,0,2600-l),m=w(g.y-.5*n,0,1800-n),d=e.createLinearGradient(0,0,0,n);d.addColorStop(0,"#263f60"),d.addColorStop(.55,"#16273f"),d.addColorStop(1,"#0b111a"),e.fillStyle=d,e.fillRect(0,0,l,n),e.strokeStyle="rgba(63,96,132,.35)",e.lineWidth=1;const x=-c%56;for(let t=-m%56;t<n;t+=56)e.beginPath(),e.moveTo(0,0|t),e.lineTo(l,0|t),e.stroke();for(let t=x;t<l;t+=56)e.beginPath(),e.moveTo(0|t,0),e.lineTo(0|t,n),e.stroke();const b=1300-c,p=900-m;e.fillStyle="rgba(105,240,201,.07)",e.beginPath(),e.arc(b,p,210,0,2*Math.PI),e.fill();const P=L(g.x,g.y,-8);for(let t=0;t<r.length;t++){const a=r[t],i=a.x-c,o=a.y-m;if(i<-a.r-30||o<-a.r-30||i>l+a.r+30||o>n+a.r+30)continue;const h="home"===a.id?0:2===y.sch[a.id],d="home"===a.id?!g.mkOn:1===y.sch[a.id];e.globalAlpha=h?.18:d?.14:.08,e.fillStyle=a.c,e.beginPath(),e.arc(i,o,a.r,0,2*Math.PI),e.fill(),e.globalAlpha=.65,e.strokeStyle=h?"#9effc8":a.c,e.lineWidth=2,e.beginPath(),e.arc(i,o,a.r,0,2*Math.PI),e.stroke(),e.globalAlpha=1,e.fillStyle="#dce8ff",e.font="600 12px Trebuchet MS,sans-serif",e.fillText(a.n,i-a.r+10,o-a.r-8);const x="home"===a.id?48:44,b=30,p=i-.5*x,u=o-.5*b;if(e.fillStyle="rgba(18,25,37,.9)",e.fillRect(p,u,x,b),e.strokeStyle="rgba(165,190,220,.55)",e.lineWidth=1,e.strokeRect(p+.5|0,u+.5|0,x-1,b-1),e.fillStyle="rgba(248,234,164,.86)",e.fillRect(p+6|0,u+6|0,11,8),e.fillRect(p+x-17|0,u+6|0,11,8),e.fillStyle="rgba(44,56,72,.95)",e.beginPath(),e.arc(p+11+Math.sin(2*y.t+t),u+11,1.7,0,2*Math.PI),e.fill(),e.beginPath(),e.arc(p+x-11+Math.sin(2*y.t+t+1),u+11,1.7,0,2*Math.PI),e.fill(),y.start&&!y.dead){const l=P?f:s,n=l[(.45*y.t+2*t|0)%l.length],r=o-.44*a.r,h=4.6*n.length+12;e.fillStyle="rgba(8,12,20,.82)",I(i-.5*h,r-9,h,16,7),e.fill(),e.fillStyle="rgba(220,240,255,.9)",e.font="600 9px Trebuchet MS,sans-serif",e.fillText(n,i-.5*h+6,r+3)}}for(let t=0;t<T.length;t++){const a=T[t],i=a.x-c,r=a.y-m;i<-10||r<-10||i>l+10||r>n+10||(e.fillStyle="#69f0c9",e.beginPath(),e.arc(i,r,5,0,2*Math.PI),e.fill(),e.fillStyle="#ceffef",e.fillRect(i-1|0,r-1|0,2,2))}for(let t=0;t<k.length;t++){const a=k[t],i=a.x-c,r=a.y-m;if(i<-a.r-20||r<-a.r-20||i>l+a.r+20||r>n+a.r+20)continue;const s=a.t/a.d;e.globalAlpha=.12+.1*s;let f="#f4d96e",o="#fff0a9";g.cat&&(f=a.m?"#53d93d":"#9fe65a",o=a.m?"#baff87":"#e4ff9a"),e.fillStyle=f,e.beginPath(),e.arc(i,r,a.r,0,2*Math.PI),e.fill(),e.globalAlpha=.2+.2*Math.sin(5*(y.t+t))*s,e.strokeStyle=o,e.lineWidth=1.5,e.beginPath(),e.arc(i,r,.68*a.r+2*Math.sin(4*(y.t+t)),0,2*Math.PI),e.stroke(),g.cat&&(e.globalAlpha=.18+.24*s,e.fillStyle=a.m?"#dbff8f":"#f1ffb3",e.beginPath(),e.arc(i+Math.sin(4*y.t+t)*a.r*.22,r-.16*a.r,2.4+.7*Math.sin(7*y.t+t),0,2*Math.PI),e.fill(),e.beginPath(),e.arc(i-.18*a.r,r+Math.sin(3*y.t+.7*t)*a.r*.14,1.9+.5*Math.sin(8*y.t+.4*t),0,2*Math.PI),e.fill(),e.beginPath(),e.arc(i+.12*a.r,r+.2*a.r,1.6+.4*Math.sin(6*y.t+.5*t),0,2*Math.PI),e.fill()),e.globalAlpha=1}for(let t=0;t<S.length;t++){const a=S[t],i=a.x-c,r=a.y-m;if(i<-40||r<-40||i>l+40||r>n+40)continue;const s=3===a.k?"#a789ff":2===a.k?"#665a78":1===a.k?"#5687a1":a.sl?"#70805a":"#4b667f";e.fillStyle=a.ht>0?"#9db4d1":s,e.beginPath(),e.arc(i,r,a.r,0,2*Math.PI),e.fill(),e.fillStyle="#f0627c",e.fillRect(i-4|0,r-2|0,3,3),e.fillRect(i+1|0,r-2|0,3,3)}for(let t=0;t<z.length;t++){const l=z[t],n=l.x-c,a=l.y-m;e.fillStyle=l.c||"#ffd56d",e.fillRect(n-2|0,a-2|0,4,4)}const A=g.x-c+g.rx,W=g.y-m+g.ry,O=Math.abs(g.vx)>=Math.abs(g.vy)?g.face>0?o.e:o.w:g.vy<0?g.face>0?o.ne:o.nw:g.face>0?o.se:o.sw;if(e.fillStyle="rgba(0,0,0,.35)",e.beginPath(),e.ellipse(A,W+14,17,6,0,0,2*Math.PI),e.fill(),O&&O.complete?e.drawImage(O,A-22,W-18,44,30):(e.fillStyle="#0b0f14",e.beginPath(),e.arc(A,W,12,0,2*Math.PI),e.fill(),e.fillStyle="#ef4f6c",e.fillRect(A+3|0,W-6|0,7,3)),g.bot){const t=g.bx-c,l=g.by-m;e.fillStyle="rgba(0,0,0,.25)",e.beginPath(),e.ellipse(t,l+8,11,4,0,0,2*Math.PI),e.fill(),e.fillStyle="#88ddff",e.beginPath(),e.arc(t,l,9,0,2*Math.PI),e.fill(),e.fillStyle="#16314a",e.fillRect(t-3|0,l-2|0,2,2),e.fillRect(t+1|0,l-2|0,2,2),e.strokeStyle="#dfffff",e.lineWidth=1.2,e.beginPath(),e.arc(t,l,12+1.5*Math.sin(9*y.t),0,2*Math.PI),e.stroke()}if(g.mkS>0&&g.zt<=0){const t=g.face>0?-1:1,l=w(g.mkS/.32,0,1),n=A+13*t,a=W+8,i=n+t*(11+2.2*Math.sin(36*y.t)),r=a+7+1.1*Math.sin(22*y.t);e.strokeStyle="rgba(248,220,112,"+(.38+.45*l)+")",e.lineWidth=2,e.beginPath(),e.moveTo(n,a),e.quadraticCurveTo(.5*(n+i),a+2,i,r),e.stroke(),e.fillStyle="rgba(250,214,103,.72)",e.beginPath(),e.arc(i+2*t,r+2,2.1,0,2*Math.PI),e.fill(),e.fillStyle="rgba(244,205,93,.38)",e.beginPath(),e.ellipse(i+5*t,r+7,5.2,2.7,0,0,2*Math.PI),e.fill()}if((g.zc>0||g.zcd>0)&&g.zt<=0){const t=g.zcd>0?0:Math.min(1,g.zc/g.zLoad),l=t<=0?Math.max(0,1-g.zcd/g.zCool):0,n=18+8*t+1.2*Math.sin(22*y.t);e.strokeStyle=g.zr?"#8fffe5":"#ffd56d",e.lineWidth=2+1.8*t,e.beginPath(),e.arc(A,W,n,.5*-Math.PI,.5*-Math.PI+2*Math.PI*t),e.stroke(),g.zcd>0&&(e.strokeStyle="rgba(158,200,255,.7)",e.lineWidth=2,e.beginPath(),e.arc(A,W,16,.5*-Math.PI,.5*-Math.PI+2*Math.PI*l),e.stroke())}if(g.zt>0){const t=g.zt/2;e.strokeStyle="rgba(143,255,229,.7)",e.lineWidth=2.5,e.beginPath(),e.arc(A,W,20+2*Math.sin(30*y.t)+4*t,0,2*Math.PI),e.stroke(),e.fillStyle="rgba(143,255,229,.16)",e.beginPath(),e.ellipse(A-10*g.zx,W-7*g.zy,20,10,Math.atan2(g.zy,g.zx),0,2*Math.PI),e.fill()}g.flash>0&&(e.globalAlpha=g.flash/.07,e.fillStyle="#ffe598",e.beginPath(),e.moveTo(A+16*g.gx,W+8*g.gy),e.lineTo(A+24*g.gx-5*g.gy,W+24*g.gy+4*g.gx),e.lineTo(A+24*g.gx+5*g.gy,W+24*g.gy-4*g.gx),e.closePath(),e.fill(),e.globalAlpha=1);for(let t=0;t<v.length;t++){const a=v[t],i=a.x-c,r=a.y-m;i<-8||r<-8||i>l+8||r>n+8||(e.globalAlpha=Math.max(0,Math.min(1,2.4*a.t)),e.fillStyle=a.c,e.fillRect(0|i,0|r,3,3))}e.globalAlpha=1;const K=44,E=l-18-K,X=l<420;let Y=62,G=74;const H=Math.max(96,l-190);if(e.fillStyle="rgba(7,10,16,.76)",e.fillRect(10,10,l-20,104),e.fillStyle="#eef4ff",e.font="700 17px Trebuchet MS,sans-serif",e.fillText("SCOTTY",20,32),X){const t=52,l=E-8;e.font="600 12px Trebuchet MS,sans-serif",e.fillStyle="#9ec8ff",e.fillText("Time "+y.time.toFixed(1)+"s",20,t),e.fillStyle="#ffd56d",e.fillText("Kills "+y.kills,118,t),e.textAlign="right",e.fillStyle="#dce8ff",e.fillText("Best "+y.best,l,t),e.textAlign="left",Y=62,G=74}else e.font="600 14px Trebuchet MS,sans-serif",e.fillStyle="#9ec8ff",e.fillText("Time "+y.time.toFixed(1)+"s",20,54),e.fillStyle="#ffd56d",e.fillText("Kills "+y.kills,150,54),e.textAlign="right",e.fillStyle="#dce8ff",e.fillText("Best "+y.best,l-24,54),e.textAlign="left";e.fillStyle="#2a3346",e.fillRect(20,Y,H,10),e.fillStyle="#ef4f6c",e.fillRect(20,Y,H*(g.hp/g.maxHp),10),e.fillStyle="#24374d",e.fillRect(20,G,H,8),e.fillStyle="#69f0c9",e.fillRect(20,G,H*(y.xp/y.nextXp),8);const _=g.mkOn?y.bd?"boss down":y.bs?"boss":y.pz&&"nsh"===y.pz.id?"nsh puzzle":y.pz&&"mel"===y.pz.id?"mel puzzle":0===y.sch.nsh?"go to nsh":1===y.sch.nsh?"nsh puzzle":0===y.sch.mel?"go 2 mellon":1===y.sch.mel?"mel puzzle":"phase2":"cohon: mints "+y.homeGot+"/"+y.homeNeed;if(e.fillStyle="rgba(8,12,19,.62)",e.fillRect(14,118,l-28,26),e.fillStyle="#d7ffe8",e.font="600 12px Trebuchet MS,sans-serif",e.fillText(_,22,135),y.start&&!y.dead){const t=(t,l,n,a,i,r)=>{e.fillStyle="rgba(8,12,19,.92)",e.fillRect(E,t,K,K),e.strokeStyle=a?l:"rgba(129,157,187,.7)",e.lineWidth=2,e.strokeRect(E+.5,t+.5,43,43),e.strokeStyle="rgba(72,88,109,.85)",e.lineWidth=3,e.beginPath(),e.arc(E+22,t+22,14.96,0,2*Math.PI),e.stroke(),e.strokeStyle=l,e.beginPath(),e.arc(E+22,t+22,14.96,.5*-Math.PI,.5*-Math.PI+2*Math.PI*w(n,0,1)),e.stroke(),e.fillStyle=l,r<1?(e.beginPath(),e.moveTo(E+21.56,t+8.36),e.lineTo(E+.35*K,t+23.32),e.lineTo(E+21.56,t+23.32),e.lineTo(E+17.16,t+36.08),e.lineTo(E+29.48,t+18.04),e.lineTo(E+22.44,t+18.04),e.closePath(),e.fill()):r<2?(e.beginPath(),e.arc(E+22,t+19.36,4.4,0,2*Math.PI),e.fill(),e.beginPath(),e.moveTo(E+22,t+8.8),e.bezierCurveTo(E+30.36,t+19.8,E+28.16,t+29.48,E+22,t+34.32),e.bezierCurveTo(E+15.84,t+29.48,E+13.64,t+19.8,E+22,t+8.8),e.fill()):(e.lineWidth=2,e.beginPath(),e.arc(E+22,t+22,.12*K,0,2*Math.PI),e.stroke(),e.beginPath(),e.arc(E+22,t+22,9.68,0,2*Math.PI),e.stroke()),i>0?(e.fillStyle="#dce8ff",e.font="700 10px Trebuchet MS,sans-serif",e.fillText(i.toFixed(1)+"s",E+8,t+K-6)):a&&(e.fillStyle="rgba(255,255,255,.8)",e.beginPath(),e.arc(E+K-8,t+8,3,0,2*Math.PI),e.fill())};t(14,"#8fffe5",g.zcd>0?1-g.zcd/g.zCool:g.zr?1:g.zc/g.zLoad,g.zt>0,g.zcd>0?g.zcd:0,0);const l=g.mkOn?g.mkT>0?1-g.mkT/g.mkI:1:0;t(66,g.cat?g.catM?"#8fdd73":"#d9e87a":"#f4d96e",l,g.mkS>0,g.mkOn&&g.mkT>0?g.mkT:0,1);const n=g.rf?g.rfT>0?1-g.rfT/g.rfI:1:0;g.rf&&t(118,"#a8b8ff",n,1,g.rfT>0?g.rfT:0,2),g.cat&&(e.fillStyle="rgba(7,10,16,.75)",e.fillRect(E-56,78,50,20),e.fillStyle="#dce8ff",e.font="600 10px Trebuchet MS,sans-serif",e.fillText(g.catM?"corr":"stick",E-50,91))}if(y.msgT>0&&(e.fillStyle="rgba(8,12,19,.74)",e.fillRect(14,148,l-28,28),e.fillStyle="#d7ffe8",e.font="600 13px Trebuchet MS,sans-serif",e.fillText(y.msg,22,167)),y.start&&!y.dead&&!y.lvup&&!y.pz){const t=M.x+M.tx,l=M.y+M.ty;e.fillStyle="rgba(7,11,17,.42)",e.beginPath(),e.arc(M.x,M.y,M.r+8,0,2*Math.PI),e.fill(),e.strokeStyle="rgba(158,200,255,.45)",e.lineWidth=2,e.beginPath(),e.arc(M.x,M.y,M.r,0,2*Math.PI),e.stroke(),e.fillStyle="rgba(105,240,201,"+(u?.65:.42)+")",e.beginPath(),e.arc(t,l,M.kr,0,2*Math.PI),e.fill(),e.strokeStyle="rgba(220,248,255,.65)",e.lineWidth=1.5,e.beginPath(),e.arc(t,l,M.kr,0,2*Math.PI),e.stroke()}if(!y.start){const t=20,a=.16*n,i=l-40,r=.68*n,s=t+16;e.fillStyle="rgba(6,9,14,.86)",e.fillRect(t,a,i,r),e.fillStyle="#fff",e.font="700 30px Trebuchet MS,sans-serif",e.fillText("what the dog doing",s,a+44),e.fillStyle="#d8e6ff",e.font="600 16px Trebuchet MS,sans-serif",e.fillStyle="#69f0c9",e.font="700 23px Trebuchet MS,sans-serif",e.fillText("tap start",s,a+178)}if(y.lvup&&!y.dead){e.fillStyle="rgba(6,10,15,.16)",e.fillRect(0,0,l,n);const t=q(),a=t.bx,i=t.by,r=t.bw,s=t.bh,f=t.rects,o=t.mobile;e.fillStyle="rgba(17,29,45,.95)",I(a,i,r,s,16),e.fill(),e.strokeStyle="rgba(90,125,163,.8)",e.lineWidth=1.2,I(a+.5,i+.5,r-1,s-1,16),e.stroke(),e.fillStyle="#ecf3ff",e.font=(o?"700 18px":"700 20px")+" Trebuchet MS,sans-serif",e.fillText("SKILL BOOK",a+14,i+24),e.fillStyle="#9ec8ff",e.font="600 12px Trebuchet MS,sans-serif",e.fillText("choose",a+14,i+39);for(let t=0;t<3;t++){const l=y.choices[t],n=f[t],a=.9+.1*R(w((y.cardT-.07*t)/.28,0,1)),i=n.x+.5*n.w,r=n.y+.5*n.h;if(e.save(),e.translate(i,r),e.scale(a,a),e.translate(-i,-r),e.fillStyle="rgba(27,44,66,.96)",I(n.x,n.y,n.w,n.h,10),e.fill(),e.strokeStyle="rgba(116,150,186,.85)",e.lineWidth=1.2,I(n.x+.5,n.y+.5,n.w-1,n.h-1,10),e.stroke(),l){const t=C(l.n)+" "+l.n;let a=o?16:17;for(;a>12&&(e.font="700 "+a+"px Trebuchet MS,sans-serif",!(e.measureText(t).width<=n.w-22));a--);e.fillStyle="#eef5ff",e.fillText(t,n.x+12,n.y+30),e.fillStyle="#a9c3e2",e.font="600 12px Trebuchet MS,sans-serif",D(l.d,n.x+12,n.y+48,n.w-24,14,2)}e.restore()}e.fillStyle="#95bce8",e.font="600 12px Trebuchet MS,sans-serif",e.fillText("tap 1/2/3",a+14,i+s-12)}if(y.pz&&!y.dead&&!y.lvup&&y.start){const t=B(),a=y.pz;if(e.fillStyle="rgba(5,9,14,.5)",e.fillRect(0,0,l,n),e.fillStyle="rgba(16,24,37,.96)",I(t.bx,t.by,t.bw,t.bh,14),e.fill(),e.strokeStyle="rgba(106,145,185,.85)",e.lineWidth=1.2,I(t.bx+.5,t.by+.5,t.bw-1,t.bh-1,14),e.stroke(),e.fillStyle="#ecf3ff",e.font="700 19px Trebuchet MS,sans-serif",e.fillText("nsh"===a.id?"nsh":"mel",t.bx+14,t.by+27),"nsh"===a.id){e.fillStyle="#dce8ff",e.font="600 12px Trebuchet MS,sans-serif",e.fillText("order",t.bx+14,t.by+66);for(let l=0;l<a.seq.length;l++){const n=t.bx+24+34*l,i=t.by+86,r=l<a.step;e.fillStyle=r?"#8cffc2":"#79d7ff",e.beginPath(),e.arc(n,i,12,0,2*Math.PI),e.fill(),e.fillStyle="#12243a",e.font="700 11px Trebuchet MS,sans-serif",e.fillText(a.seq[l]+1+"",n-3,i+4)}}else{const l=["#8fd3ff","#ffd58f","#ff9fb7"];e.fillStyle="#dce8ff",e.font="600 12px Trebuchet MS,sans-serif",e.fillText("mix",t.bx+14,t.by+66);for(let n=0;n<a.seq.length;n++){const i=t.bx+24+30*n,r=t.by+86,s=n<a.step;e.fillStyle=l[a.seq[n]],e.beginPath(),e.arc(i,r,10,0,2*Math.PI),e.fill(),s&&(e.strokeStyle="#8cffc2",e.lineWidth=2,e.beginPath(),e.arc(i,r,12,0,2*Math.PI),e.stroke())}}for(let l=0;l<3;l++){const n=t.btn[l];e.fillStyle="nsh"===a.id?"rgba(37,87,129,.96)":["#3c6588","#9a6f3f","#8e4f64"][l],I(n.x,n.y,n.w,n.h,10),e.fill(),e.strokeStyle="rgba(196,223,255,.72)",e.lineWidth=1.1,I(n.x+.5,n.y+.5,n.w-1,n.h-1,10),e.stroke(),e.fillStyle="#eef5ff",e.font="700 13px Trebuchet MS,sans-serif",e.fillText("nsh"===a.id?"terminal "+(l+1):["blue","amber","rose"][l],n.x+9,n.y+28)}e.fillStyle="#9ec8ff",e.font="600 11px Trebuchet MS,sans-serif",e.fillText("tap 1/2/3",t.bx+14,t.by+t.bh-10)}y.dead&&(e.fillStyle="rgba(5,8,13,.86)",e.fillRect(24,.24*n,l-48,.5*n),e.fillStyle="#ff8298",e.font="700 33px Trebuchet MS,sans-serif",e.fillText("GAME OVER",.5*l-98,.38*n),e.fillStyle="#dce8ff",e.font="600 20px Trebuchet MS,sans-serif",e.fillText("Kills "+y.kills,.5*l-43,.47*n),e.fillText("Best "+y.best,.5*l-37,.53*n),e.fillStyle="#69f0c9",e.font="700 24px Trebuchet MS,sans-serif",e.fillText("tap retry",.5*l-56,.65*n))}(),requestAnimationFrame(t)})})();</script></body></html>