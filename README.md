# Project: Zoomies

`Project: Zoomies` is a portrait mobile browser game set at CMU, where stepping outside is deadly and Scotty is the only runner fast enough to reconnect the campus.

## Play Online (GitHub Pages)

https://floaredor.github.io/what-the-dog-doing/

## Leaderboard (Supabase)

The leaderboard now uses Supabase directly from the browser (works with GitHub Pages).

- Page: `/leaderboard.html`
- UI: global top 10 + your latest rank
- Sort order: `kills DESC`, then `time_seconds ASC`
- Game flow: on game over, players can opt in and auto-submit score (name + kills + time)
- Config file: `src/leaderboard-config.js`

Update `src/leaderboard-config.js` with your Supabase values:

```js
window.LEADERBOARD_CONFIG = {
  supabaseUrl: "https://YOUR_PROJECT.supabase.co",
  supabaseAnonKey: "YOUR_SUPABASE_ANON_KEY",
  table: "leaderboard_entries",
};
```

Run this SQL in Supabase SQL Editor:

```sql
create table if not exists public.leaderboard_entries (
  id bigint generated by default as identity primary key,
  name text not null,
  kills integer not null,
  time_seconds numeric(10,1) not null,
  created_at timestamptz not null default now(),
  constraint leaderboard_name_len check (char_length(name) between 1 and 24),
  constraint leaderboard_name_chars check (name ~ '^[A-Za-z0-9 _.\-]+$'),
  constraint leaderboard_kills_range check (kills between 0 and 1000000),
  constraint leaderboard_time_range check (time_seconds >= 0 and time_seconds <= 86400)
);

create or replace function public.contains_blocked_name(input text)
returns boolean
language sql
immutable
as $$
  select regexp_replace(lower(coalesce(input, '')), '[^a-z0-9]', '', 'g')
    ~ '(fuck|shit|bitch|cunt|nigg|faggot|whore|slut|dick|cock|pussy|asshole|motherfucker)';
$$;

alter table public.leaderboard_entries
  add constraint leaderboard_name_clean
  check (not public.contains_blocked_name(name));

alter table public.leaderboard_entries enable row level security;

create policy "leaderboard_select_all"
on public.leaderboard_entries
for select
to anon
using (true);

create policy "leaderboard_insert_anon"
on public.leaderboard_entries
for insert
to anon
with check (true);
```

The page also has a small 5-second client submit cooldown. For strict rate limiting, use a Supabase Edge Function in front of inserts.

You can also apply the same migration from this repo:

```bash
# put DATABASE_URL in .env first
npm run migrate:init
```

Migration file:

- `supabase/migrations/0001_init_leaderboard.sql`

## lore

ppl are stuck in campus buildings, and if they step outside they die. the goops have spread across cmu paths, entrances, and key routes, so every rescue run is dangerous.

scotty is the only one fast enough to move between buildings. in home base, scotty starts with `zoomies` as the base ability and quickly unlocks early territory so the first safe routes can open.

scotty tries to win with speed alone, but it is too hard because the goops keep growing, swarming lanes, and blocking evac routes. so the plan shifts: go college by college and team up with professors, staff, and students.

each college has an easy, fun mission (mostly puzzle-based, with light goop-clearing combat that fits the lore because scotty is protecting routes, not fighting people). finishing each mission unlocks a new ability:

- hamerschlag (engineering): `coil turret`
- gates hillman (scs): `target patch`
- newell-simon (ri): `bot buddy`
- wean (physics + cs): `repel field`
- mellon institute (chemistry): `catalyst mix`
- baker (psychology): `focus bark`

with each unlock, scotty gets better at controlling goops, reopening paths, and guiding survivors. in the final push against the `dean of goop`, all college abilities combine so scotty can reconnect campus and save cmu.

## Controls

- Tap center: jump / double-jump
- Tap left or right side: wallrun lane shift
- Swipe down: slide
- Hold touch near yellow ring: grapple pull

## Local Setup and Run

Requirements:

- Node.js 20+
- npm

Commands:

```bash
npm run build
npm run start
```

Then open `http://localhost:8000` on a phone (or mobile simulator), since gameplay is tuned for portrait mobile input.
For leaderboard UI, open `http://localhost:8000/leaderboard.html`.

## Hosting Notes

- GitHub can host your code repository.
- GitHub Pages hosts the static game + leaderboard UI.
- Supabase hosts leaderboard storage/query.
- No separate Node backend is required for leaderboard writes/reads.

## Submission Build

```bash
npm run build
npm run pack
```

Generated artifacts:

- `build/index.html`
- `build/game.tar`
- `build/game.tar.br`

Final artifact to submit:

- Local path: `E:\cmu-e\tartanhacks\what\hamish\build\game.tar.br`
- GitHub file link: [`build/game.tar.br`](https://github.com/FloareDor/what-the-dog-doing/blob/main/build/game.tar.br)

Submission checklist:

- Hosted game link (GitHub Pages): `https://floaredor.github.io/what-the-dog-doing/`
- Offline validation artifact upload: `build/game.tar.br`

`npm run pack` reports whether `build/game.tar.br` is within the 15360-byte submission limit.
